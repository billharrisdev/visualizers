(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[85],{179:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(5155),n=a(2115),l=a(3160),c=a(6369);let s=[{t:0,rgb:[68,1,84]},{t:.25,rgb:[59,82,139]},{t:.5,rgb:[33,145,140]},{t:.75,rgb:[94,201,98]},{t:1,rgb:[253,231,37]}],u=e=>440*Math.pow(2,(e-69)/12),i=e=>[1,3,6,8,10].includes((e%12+12)%12),o=e=>"".concat(["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][(e%12+12)%12]).concat(Math.floor(e/12)-1);function d(){let e=(0,n.useRef)(null),t=(0,n.useRef)(null),{analyser:a,ctx:d,play:m,pause:f,stop:h,isPlaying:g,setVolume:x}=(0,l.e)({fftSize:2048,smoothingTimeConstant:.6}),[b,p]=(0,n.useState)(0),[v,M]=(0,n.useState)(.7);(0,n.useEffect)(()=>x(v),[v,x]);let k=(0,n.useMemo)(()=>(e,t,a)=>Math.round((1-Math.max(0,Math.min(1,Math.log(e/20)/Math.log(a/2/20))))*(t-1)),[]);return(0,n.useEffect)(()=>{if(!d)return;let e=t.current;if(!e)return;let a=e.getContext("2d");if(!a)return;let r=e.width,n=e.height;a.clearRect(0,0,r,n),a.fillStyle="#f8fafc",a.fillRect(0,0,r,n);for(let e=21;e<=108;e++){let t=k(u(e+1),n,d.sampleRate),l=k(u(e),n,d.sampleRate);i(e)||(a.fillStyle="#e5e7eb",a.fillRect(0,t,r,l-t),a.strokeStyle="#cbd5e1",a.lineWidth=1,a.beginPath(),a.moveTo(.5,t+.5),a.lineTo(r-.5,t+.5),a.stroke())}for(let e=21;e<=108;e++)if(i(e)){let t=k(u(e+1),n,d.sampleRate),l=k(u(e),n,d.sampleRate),c=Math.floor(.6*r),s=Math.floor((r-c)/2);a.fillStyle="#0f172a",a.fillRect(s,t,c,l-t)}a.fillStyle="#334155",a.font="11px sans-serif",a.textAlign="center";for(let e=21;e<=108;e++)if((e%12+12)%12==0){let t=Math.round((k(u(e+1),n,d.sampleRate)+k(u(e),n,d.sampleRate))/2);a.fillText(o(e),Math.floor(r/2),t+4)}a.strokeStyle="#94a3b8",a.lineWidth=1,a.strokeRect(.5,.5,r-1,n-1)},[d,k]),(0,n.useEffect)(()=>{if(!a||!d)return;let t=e.current,r=t.getContext("2d");if(!r)return;let n=t.width,l=t.height,c=a.frequencyBinCount,u=new Float32Array(c),i=()=>{if(!a||!d)return;let e=r.getImageData(1,0,n-1,l);r.putImageData(e,0,0),a.getFloatFrequencyData(u);for(let e=0;e<l;e++){let t=1-e/(l-1),a=(u[Math.min(c-1,Math.max(0,Math.round(20*Math.pow(d.sampleRate/2/20,t)/(d.sampleRate/2)*c)))]+100)/70;r.fillStyle=function(e){let t=Math.max(0,Math.min(1,e)),a=0;for(;a<s.length-1&&t>s[a+1].t;)a++;let r=s[a],n=s[Math.min(a+1,s.length-1)],l=Math.max(1e-6,n.t-r.t),c=(t-r.t)/l,u=Math.round(r.rgb[0]+(n.rgb[0]-r.rgb[0])*c),i=Math.round(r.rgb[1]+(n.rgb[1]-r.rgb[1])*c),o=Math.round(r.rgb[2]+(n.rgb[2]-r.rgb[2])*c);return"rgb(".concat(u,", ").concat(i,", ").concat(o,")")}(Math.pow(a=Math.max(0,Math.min(1,a)),.8)),r.fillRect(n-1,e,1,1)}requestAnimationFrame(i)};requestAnimationFrame(i)},[a,d]),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-end gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Track"}),(0,r.jsx)("select",{className:"border rounded-md px-3 py-2 bg-background",value:b,onChange:e=>p(Number(e.target.value)),disabled:g,children:c.p.map((e,t)=>(0,r.jsx)("option",{value:t,children:e.label},e.file))})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:()=>m(c.p[b].file),disabled:g,children:"Play"}),(0,r.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:f,disabled:!g,children:"Pause"}),(0,r.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:h,children:"Stop"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("label",{className:"text-sm text-muted-foreground",children:"Volume"}),(0,r.jsx)("input",{type:"range",min:0,max:1,step:.01,value:v,onChange:e=>M(Number(e.target.value)),className:"w-40"}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground tabular-nums",children:[Math.round(100*v),"%"]})]})]}),(0,r.jsx)("div",{className:"border rounded-lg p-3 bg-muted/20 overflow-x-auto",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("canvas",{ref:e,width:900,height:360,className:"w-full h-[360px]"}),(0,r.jsx)("canvas",{ref:t,width:64,height:360,className:"h-[360px] w-[64px]"})]})})]})}function m(){return(0,r.jsxs)("section",{className:"py-8 container max-w-5xl",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Spectrogram Waterfall"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6",children:"Scrolling time–frequency heatmap using FFT magnitudes."}),(0,r.jsx)(d,{})]})}},861:(e,t,a)=>{"use strict";function r(e){let t="/visualizers";return!t||e.startsWith(t+"/")?e:e.startsWith("/")?"".concat(t).concat(e):"".concat(t,"/").concat(e)}a.d(t,{O:()=>r})},3160:(e,t,a)=>{"use strict";a.d(t,{e:()=>l});var r=a(2115),n=a(861);function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{fftSize:t=2048,smoothingTimeConstant:a=.8}=e,l=(0,r.useRef)(null),c=(0,r.useRef)(null),s=(0,r.useRef)(null),u=(0,r.useRef)(null),i=(0,r.useRef)(null),[o,d]=(0,r.useState)(!1),[m,f]=(0,r.useState)(.7);(0,r.useEffect)(()=>{let e=new Audio;return e.crossOrigin="anonymous",l.current=e,()=>{e.pause(),e.src="",l.current=null}},[]);let h=(0,r.useCallback)(async()=>{let e=c.current;if(e||(c.current=e=new(window.AudioContext||window.webkitAudioContext)),s.current||(s.current=e.createMediaElementSource(l.current)),!u.current){let r=e.createAnalyser();r.fftSize=t,r.smoothingTimeConstant=a,u.current=r}if(!i.current){let t=e.createGain();t.gain.value=m,i.current=t}s.current.disconnect(),i.current.disconnect(),u.current.disconnect(),s.current.connect(i.current),i.current.connect(e.destination),s.current.connect(u.current)},[t,a,m]);(0,r.useEffect)(()=>{i.current&&(i.current.gain.value=m)},[m]);let g=(0,r.useCallback)(async e=>{await h();let t=l.current;t.src=(0,n.O)(e),await t.play(),d(!0)},[h]),x=(0,r.useCallback)(()=>{var e;null==(e=l.current)||e.pause(),d(!1)},[]),b=(0,r.useCallback)(()=>{l.current&&(l.current.pause(),l.current.currentTime=0),d(!1)},[]);return(0,r.useEffect)(()=>()=>{try{var e,t,a,r;null==(e=u.current)||e.disconnect(),null==(t=i.current)||t.disconnect(),null==(a=s.current)||a.disconnect(),null==(r=c.current)||r.close()}catch(e){}},[]),{audio:l.current,ctx:c.current,analyser:u.current,isPlaying:o,volume:m,setVolume:f,play:g,pause:x,stop:b}}},6369:(e,t,a)=>{"use strict";a.d(t,{p:()=>r});let r=[{label:"Rock – Take the Lead (Kevin MacLeod)",file:"/audio/kevin-macleod_take-the-lead.mp3",genre:"Rock"},{label:"Jazz – George Street Shuffle (Kevin MacLeod)",file:"/audio/kevin-macleod_george-street-shuffle.mp3",genre:"Jazz"},{label:"Metal – Metalmania (Kevin MacLeod)",file:"/audio/kevin-macleod_metalmania.mp3",genre:"Metal"},{label:"Industrial – Industrial Music Box (Kevin MacLeod)",file:"/audio/kevin-macleod_industrial-music-box.mp3",genre:"Industrial"}]},8850:(e,t,a)=>{Promise.resolve().then(a.bind(a,179))}},e=>{e.O(0,[441,964,358],()=>e(e.s=8850)),_N_E=e.O()}]);