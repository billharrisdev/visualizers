(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[613],{861:(e,t,r)=>{"use strict";function n(e){let t="/visualizers";return!t||e.startsWith(t+"/")?e:e.startsWith("/")?"".concat(t).concat(e):"".concat(t,"/").concat(e)}r.d(t,{O:()=>n})},3160:(e,t,r)=>{"use strict";r.d(t,{e:()=>a});var n=r(2115),l=r(861);function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{fftSize:t=2048,smoothingTimeConstant:r=.8}=e,a=(0,n.useRef)(null),c=(0,n.useRef)(null),s=(0,n.useRef)(null),u=(0,n.useRef)(null),i=(0,n.useRef)(null),[o,d]=(0,n.useState)(!1),[f,m]=(0,n.useState)(.7);(0,n.useEffect)(()=>{let e=new Audio;return e.crossOrigin="anonymous",a.current=e,()=>{e.pause(),e.src="",a.current=null}},[]);let h=(0,n.useCallback)(async()=>{let e=c.current;if(e||(c.current=e=new(window.AudioContext||window.webkitAudioContext)),s.current||(s.current=e.createMediaElementSource(a.current)),!u.current){let n=e.createAnalyser();n.fftSize=t,n.smoothingTimeConstant=r,u.current=n}if(!i.current){let t=e.createGain();t.gain.value=f,i.current=t}s.current.disconnect(),i.current.disconnect(),u.current.disconnect(),s.current.connect(i.current),i.current.connect(e.destination),s.current.connect(u.current)},[t,r,f]);(0,n.useEffect)(()=>{i.current&&(i.current.gain.value=f)},[f]);let x=(0,n.useCallback)(async e=>{await h();let t=a.current;t.src=(0,l.O)(e),await t.play(),d(!0)},[h]),g=(0,n.useCallback)(()=>{var e;null==(e=a.current)||e.pause(),d(!1)},[]),p=(0,n.useCallback)(()=>{a.current&&(a.current.pause(),a.current.currentTime=0),d(!1)},[]);return(0,n.useEffect)(()=>()=>{try{var e,t,r,n;null==(e=u.current)||e.disconnect(),null==(t=i.current)||t.disconnect(),null==(r=s.current)||r.disconnect(),null==(n=c.current)||n.close()}catch(e){}},[]),{audio:a.current,ctx:c.current,analyser:u.current,isPlaying:o,volume:f,setVolume:m,play:x,pause:g,stop:p}}},5128:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var n=r(5155),l=r(2115),a=r(3160),c=r(6369);let s=[6.35,2.23,3.48,2.33,4.38,4.09,2.52,5.19,2.39,3.66,2.29,2.88],u=[6.33,2.68,3.52,5.38,2.6,3.53,2.54,4.75,3.98,2.69,3.34,3.17],i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function o(e,t){let r=e.length,n=Array(r);for(let l=0;l<r;l++)n[(l+t)%r]=e[l];return n}function d(e){let t=e.reduce((e,t)=>e+t,0)||1;return e.map(e=>e/t)}function f(){let e=(0,l.useRef)(null),{analyser:t,play:r,pause:f,stop:m,isPlaying:h,setVolume:x,ctx:g}=(0,a.e)({fftSize:4096,smoothingTimeConstant:.8}),[p,b]=(0,l.useState)(0),[v,j]=(0,l.useState)(.7),[y,M]=(0,l.useState)(.7),[N,k]=(0,l.useState)(!0),C=(0,l.useRef)(!0);(0,l.useEffect)(()=>{C.current=N},[N]),(0,l.useEffect)(()=>x(v),[v,x]);let S=(0,l.useMemo)(()=>{var e;if(!t)return null;let r=null!=(e=null==g?void 0:g.sampleRate)?e:44100,n=t.frequencyBinCount,l=Array(n).fill(-1);for(let e=1;e<n;e++){let n=e*r/t.fftSize;if(n<27.5||n>5e3)continue;let a=69+12*Math.log2(n/440);l[e]=(Math.round(a)%12+12)%12}return l},[t,g]),w=(0,l.useRef)(Array(12).fill(0)),R=(0,l.useRef)(null),A=(0,l.useRef)({mode:"maj",major:0,minor:0}),E=e=>30*e%360;return(0,l.useEffect)(()=>{if(!t||!S)return;let r=e.current,n=r.getContext("2d");if(!n)return;let l=t.frequencyBinCount,a=new Uint8Array(l),c=()=>{if(!t)return;requestAnimationFrame(c),t.getByteFrequencyData(a);let e=Array(12).fill(0);for(let t=0;t<l;t++){let r=S[t];r<0||(e[r]+=a[t]/255)}let f=d(e);for(let e=0;e<12;e++)w.current[e]=w.current[e]*y+f[e]*(1-y);let m=d(s),h=d(u),x=-1/0,g="C",p="maj",b=0;for(let e=0;e<12;e++){let t=o(m,e),r=o(h,e),n=0,l=0;for(let e=0;e<12;e++)n+=w.current[e]*t[e],l+=w.current[e]*r[e];n>x&&(x=n,g=i[e],p="maj",b=e),l>x&&(x=l,g=i[e],p="min",b=e)}R.current="".concat(g," ").concat(p);let v=o(m,b),j=o(h,b),M=0,N=0;for(let e=0;e<12;e++)M+=w.current[e]*v[e],N+=w.current[e]*j[e];A.current={mode:p,major:M,minor:N};let k=r.width,P=r.height;n.clearRect(0,0,k,P);let T=.42*Math.min(k,P),_=.55*T;n.save(),n.translate(k/2,P/2);for(let e=0;e<12;e++){let t=e/12*Math.PI*2,r=(e+1)/12*Math.PI*2,l=Math.min(1,3*w.current[e]),a=_+(T-_)*l;n.beginPath(),n.moveTo(_*Math.cos(t),_*Math.sin(t)),n.arc(0,0,a,t,r),n.lineTo(_*Math.cos(r),_*Math.sin(r)),n.closePath(),n.fillStyle="hsl(".concat(E(e)," 80% ").concat(Math.round(35+35*l),"%)"),n.fill(),n.save();let c=(t+r)/2,s=T+18;n.translate(s*Math.cos(c),s*Math.sin(c)),n.rotate(c+Math.PI/2),n.fillStyle="#94a3b8",n.font="12px sans-serif",n.textAlign="center",n.fillText(i[e],0,0),n.restore()}if(C.current)for(let e of"maj"===p?[0,4,7]:[0,3,7]){let t=((b+e)%12+.5)/12*Math.PI*2,r=T+6;n.fillStyle="#f59e0b",n.beginPath(),n.arc(r*Math.cos(t),r*Math.sin(t),4,0,2*Math.PI),n.fill()}n.restore(),n.fillStyle="#e5e7eb",n.font="bold 22px sans-serif",n.textAlign="center",n.fillText(R.current||"",k/2,P/2+8);let z=A.current,F=z.major+z.minor||1,I=z.major/F,K=z.minor/F,q=P/2+28;n.fillStyle="#1f2937",n.fillRect(k/2-70,q,140,8),n.fillStyle="#22c55e",n.fillRect(k/2-70,q,140*I,8),n.fillStyle="#ef4444",n.fillRect(k/2-70+140*I,q,140*K,8),n.fillStyle="#9ca3af",n.font="12px sans-serif",n.fillText("maj ".concat((100*I).toFixed(0),"% / min ").concat((100*K).toFixed(0),"%"),k/2,q-2)};requestAnimationFrame(c)},[t,S,y]),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-end gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Track"}),(0,n.jsx)("select",{className:"border rounded-md px-3 py-2 bg-background",value:p,onChange:e=>b(Number(e.target.value)),disabled:h,children:c.p.map((e,t)=>(0,n.jsx)("option",{value:t,children:e.label},e.file))})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:()=>r(c.p[p].file),disabled:h,children:"Play"}),(0,n.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:f,disabled:!h,children:"Pause"}),(0,n.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:m,children:"Stop"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm text-muted-foreground",children:"Volume"}),(0,n.jsx)("input",{type:"range",min:0,max:1,step:.01,value:v,onChange:e=>j(Number(e.target.value)),className:"w-40"}),(0,n.jsxs)("span",{className:"text-xs text-muted-foreground tabular-nums",children:[Math.round(100*v),"%"]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm text-muted-foreground",children:"Smoothing"}),(0,n.jsx)("input",{type:"range",min:.3,max:.95,step:.01,value:y,onChange:e=>M(Number(e.target.value)),className:"w-40"}),(0,n.jsx)("span",{className:"text-xs text-muted-foreground tabular-nums",children:y.toFixed(2)})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm text-muted-foreground",children:"Chords"}),(0,n.jsx)("input",{type:"checkbox",checked:N,onChange:e=>k(e.target.checked)})]})]}),(0,n.jsx)("div",{className:"border rounded-lg p-3 bg-muted/20",children:(0,n.jsx)("canvas",{ref:e,width:900,height:420,className:"w-full h-[420px]"})})]})}function m(){return(0,n.jsxs)("section",{className:"py-8 container max-w-5xl",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Chromagram / Key Wheel"}),(0,n.jsx)("p",{className:"text-muted-foreground mb-6",children:"12 pitch classes around a ring with key detection (Krumhansl profiles)."}),(0,n.jsx)(f,{})]})}},6369:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});let n=[{label:"Rock – Take the Lead (Kevin MacLeod)",file:"/audio/kevin-macleod_take-the-lead.mp3",genre:"Rock"},{label:"Jazz – George Street Shuffle (Kevin MacLeod)",file:"/audio/kevin-macleod_george-street-shuffle.mp3",genre:"Jazz"},{label:"Metal – Metalmania (Kevin MacLeod)",file:"/audio/kevin-macleod_metalmania.mp3",genre:"Metal"},{label:"Industrial – Industrial Music Box (Kevin MacLeod)",file:"/audio/kevin-macleod_industrial-music-box.mp3",genre:"Industrial"}]},8156:(e,t,r)=>{Promise.resolve().then(r.bind(r,5128))}},e=>{e.O(0,[441,964,358],()=>e(e.s=8156)),_N_E=e.O()}]);