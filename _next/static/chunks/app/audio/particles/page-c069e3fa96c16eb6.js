(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[747],{861:(e,t,r)=>{"use strict";function n(e){let t="/visualizers";return!t||e.startsWith(t+"/")?e:e.startsWith("/")?"".concat(t).concat(e):"".concat(t,"/").concat(e)}r.d(t,{O:()=>n})},2197:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var n=r(5155),a=r(2115),l=r(7431),s=r(4426),c=r(8446),u=r(5037),i=r(3160),o=r(6369);function d(){let e=(0,a.useRef)(null),{analyser:t,ctx:r,play:d,pause:m,stop:x,isPlaying:h,setVolume:f}=(0,i.e)({fftSize:1024,smoothingTimeConstant:.7}),[p,g]=(0,a.useState)(0),[b,v]=(0,a.useState)(.7),w=(0,a.useRef)(null),j=(0,a.useRef)(null),M=(0,a.useRef)(null),y=(0,a.useRef)(null),N=(0,a.useRef)(null),k=(0,a.useRef)(null),S=(0,a.useRef)(null),C=(0,a.useRef)(!1),R=(0,a.useRef)(null),A=(0,a.useRef)(null),[E,z]=(0,a.useState)("medium"),[L,_]=(0,a.useState)(!0),[P,F]=(0,a.useState)(0),[B,H]=(0,a.useState)(60),q=(0,a.useRef)({quality:"medium",bloom:!0,focusDist:0,focusSpread:60});(0,a.useEffect)(()=>{q.current={quality:E,bloom:L,focusDist:P,focusSpread:B}},[E,L,P,B]);let I=(0,a.useRef)(null);return(0,a.useEffect)(()=>f(b),[b,f]),(0,a.useEffect)(()=>{let n=e.current;if(!n)return;let a=n.clientWidth,i=n.clientHeight||480,o=new l.JeP({antialias:!0,alpha:!0});o.setPixelRatio(Math.min(window.devicePixelRatio,2)),o.setSize(a,i),n.appendChild(o.domElement),w.current=o;let d=new l.Z58;j.current=d;let m=new l.ubm(60,a/i,.1,1e3);m.position.set(0,0,140),M.current=m;let x=new l.$p8(0xffffff,.35);d.add(x);let h=new l.HiM(3900150,1.2,600);h.position.set(50,120,160),d.add(h);let f="low"===E?400:"high"===E?1600:900,p=new Float32Array(3*f),g=new Float32Array(3*f),b=new Float32Array(f);for(let e=0;e<f;e++){let t=3*e;p[t]=(2*Math.random()-1)*95,p[t+1]=(2*Math.random()-1)*95,p[t+2]=(2*Math.random()-1)*95,g[t]=(2*Math.random()-1)*.25,g[t+1]=(2*Math.random()-1)*.25,g[t+2]=(2*Math.random()-1)*.25,b[e]=.4+1.1*Math.random()}N.current=g,k.current=b;let v="high"===E?24:16,z=new l.Gu$(1,v,v),L=new l._4j({color:6333946,emissive:new l.Q1f(1920728).multiplyScalar(.4),roughness:.3,metalness:.15}),_=new l.ZLX(z,L,f);_.instanceMatrix.setUsage(l.Vnu),d.add(_),y.current=_;let P=new l.B69;for(let e=0;e<f;e++){let t=3*e;P.position.set(p[t],p[t+1],p[t+2]);let r=b[e];P.scale.setScalar(r),P.updateMatrix(),_.setMatrixAt(e,P.matrix)}_.instanceMatrix.needsUpdate=!0;let F=new s.s(o),B=new c.A(d,m);F.addPass(B);let H=new u.C(new l.I9Y(a,i),.75,.4,.85);F.addPass(H),R.current=F,A.current=H;let O=()=>{if(!w.current||!M.current||!e.current)return;let t=e.current.clientWidth,r=e.current.clientHeight||480;w.current.setSize(t,r),M.current.aspect=t/r,M.current.updateProjectionMatrix(),R.current&&R.current.setSize(t,r),A.current&&A.current.setSize(t,r)};window.addEventListener("resize",O);let T=()=>{I.current=requestAnimationFrame(T);let e=y.current,n=N.current,a=k.current,s=new l.kn4,c=new l.B69;S.current||(S.current=new Float32Array(3*e.count));let u=S.current;if(!C.current){for(let t=0;t<e.count;t++){e.getMatrixAt(t,s),s.decompose(c.position,c.quaternion,c.scale);let r=3*t;u[r]=c.position.x,u[r+1]=c.position.y,u[r+2]=c.position.z}C.current=!0}let i=0,x=0,h=0;if(t&&r){let e=t.frequencyBinCount,n=new Uint8Array(e);t.getByteFrequencyData(n);let a=r.sampleRate/2,l=t=>Math.max(0,Math.min(e-1,Math.round(t/a*e))),s=(e,t)=>{let r=l(e),a=l(t),s=0,c=0;for(let e=r;e<=a;e++)s+=n[e],c++;return c?s/(255*c):0};i=s(20,150),x=s(150,2e3),h=s(2e3,8e3)}let f=.5+2*x,{bloom:p,focusDist:g,focusSpread:b}=q.current,v=Math.max(5,b);for(let t=0;t<e.count;t++){let r=3*t;u[r]+=n[r]*f,u[r+1]+=n[r+1]*f,u[r+2]+=n[r+2]*f,u[r]>95?u[r]=-95:u[r]<-95&&(u[r]=95),u[r+1]>95?u[r+1]=-95:u[r+1]<-95&&(u[r+1]=95),u[r+2]>95?u[r+2]=-95:u[r+2]<-95&&(u[r+2]=95);let l=Math.exp(-Math.pow((u[r+2]-g)/v,2)),s=a[t]*(1+1.6*i)*(.4+.6*l);c.position.set(u[r],u[r+1],u[r+2]),c.scale.setScalar(s),c.updateMatrix(),e.setMatrixAt(t,c.matrix)}e.instanceMatrix.needsUpdate=!0;let w=e.material,j=new l.Q1f().setHSL(.58-.18*Math.max(0,Math.min(1,h)),.75,.55+.15*h);w.color.lerp(j,.15),w.emissiveIntensity=.3+1.1*x,w.emissive=new l.Q1f().setHSL(.58-.2*h,.9,.35+.25*h),A.current&&(A.current.strength=p?.9+.6*i:0),e.rotation.y+=8e-4+.008*h,e.rotation.x+=3e-4+.002*i,R.current?R.current.render():o.render(d,m)};return T(),()=>{if(I.current&&cancelAnimationFrame(I.current),window.removeEventListener("resize",O),w.current){var e;w.current.dispose();let t=w.current.domElement;null==(e=t.parentElement)||e.removeChild(t)}y.current&&(y.current.geometry.dispose(),y.current.material.dispose()),R.current&&(R.current.passes.length=0),R.current=null,d.clear()}},[t,r,E]),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-end gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Track"}),(0,n.jsx)("select",{className:"border rounded-md px-3 py-2 bg-background",value:p,onChange:e=>g(Number(e.target.value)),disabled:h,children:o.p.map((e,t)=>(0,n.jsx)("option",{value:t,children:e.label},e.file))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Quality"}),(0,n.jsxs)("select",{className:"border rounded-md px-3 py-2 bg-background",value:E,onChange:e=>z(e.target.value),disabled:h,children:[(0,n.jsx)("option",{value:"low",children:"Low"}),(0,n.jsx)("option",{value:"medium",children:"Medium"}),(0,n.jsx)("option",{value:"high",children:"High"})]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:()=>d(o.p[p].file),disabled:h,children:"Play"}),(0,n.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:m,disabled:!h,children:"Pause"}),(0,n.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:x,children:"Stop"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm text-muted-foreground",children:"Volume"}),(0,n.jsx)("input",{type:"range",min:0,max:1,step:.01,value:b,onChange:e=>v(Number(e.target.value)),className:"w-40"}),(0,n.jsxs)("span",{className:"text-xs text-muted-foreground tabular-nums",children:[Math.round(100*b),"%"]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm text-muted-foreground",children:"Bloom"}),(0,n.jsx)("input",{type:"checkbox",checked:L,onChange:e=>_(e.target.checked)})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm text-muted-foreground",children:"Focus Z"}),(0,n.jsx)("input",{type:"range",min:-100,max:100,step:1,value:P,onChange:e=>F(Number(e.target.value))}),(0,n.jsx)("span",{className:"text-xs text-muted-foreground w-8 text-right",children:P})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm text-muted-foreground",children:"Spread"}),(0,n.jsx)("input",{type:"range",min:10,max:120,step:5,value:B,onChange:e=>H(Number(e.target.value))}),(0,n.jsx)("span",{className:"text-xs text-muted-foreground w-8 text-right",children:B})]})]}),(0,n.jsx)("div",{className:"border rounded-lg p-3 bg-muted/20",children:(0,n.jsx)("div",{ref:e,className:"w-full h-[480px]"})})]})}function m(){return(0,n.jsxs)("section",{className:"py-8 container max-w-5xl",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"3D Particle Field"}),(0,n.jsx)("p",{className:"text-muted-foreground mb-6",children:"three.js particles reacting to bass/mids/highs."}),(0,n.jsx)(d,{})]})}},3160:(e,t,r)=>{"use strict";r.d(t,{e:()=>l});var n=r(2115),a=r(861);function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{fftSize:t=2048,smoothingTimeConstant:r=.8}=e,l=(0,n.useRef)(null),s=(0,n.useRef)(null),c=(0,n.useRef)(null),u=(0,n.useRef)(null),i=(0,n.useRef)(null),[o,d]=(0,n.useState)(!1),[m,x]=(0,n.useState)(.7);(0,n.useEffect)(()=>{let e=new Audio;return e.crossOrigin="anonymous",l.current=e,()=>{e.pause(),e.src="",l.current=null}},[]);let h=(0,n.useCallback)(async()=>{let e=s.current;if(e||(s.current=e=new(window.AudioContext||window.webkitAudioContext)),c.current||(c.current=e.createMediaElementSource(l.current)),!u.current){let n=e.createAnalyser();n.fftSize=t,n.smoothingTimeConstant=r,u.current=n}if(!i.current){let t=e.createGain();t.gain.value=m,i.current=t}c.current.disconnect(),i.current.disconnect(),u.current.disconnect(),c.current.connect(i.current),i.current.connect(e.destination),c.current.connect(u.current)},[t,r,m]);(0,n.useEffect)(()=>{i.current&&(i.current.gain.value=m)},[m]);let f=(0,n.useCallback)(async e=>{await h();let t=l.current;t.src=(0,a.O)(e),await t.play(),d(!0)},[h]),p=(0,n.useCallback)(()=>{var e;null==(e=l.current)||e.pause(),d(!1)},[]),g=(0,n.useCallback)(()=>{l.current&&(l.current.pause(),l.current.currentTime=0),d(!1)},[]);return(0,n.useEffect)(()=>()=>{try{var e,t,r,n;null==(e=u.current)||e.disconnect(),null==(t=i.current)||t.disconnect(),null==(r=c.current)||r.disconnect(),null==(n=s.current)||n.close()}catch(e){}},[]),{audio:l.current,ctx:s.current,analyser:u.current,isPlaying:o,volume:m,setVolume:x,play:f,pause:p,stop:g}}},3544:(e,t,r)=>{Promise.resolve().then(r.bind(r,2197))},6369:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});let n=[{label:"Rock – Take the Lead (Kevin MacLeod)",file:"/audio/kevin-macleod_take-the-lead.mp3",genre:"Rock"},{label:"Jazz – George Street Shuffle (Kevin MacLeod)",file:"/audio/kevin-macleod_george-street-shuffle.mp3",genre:"Jazz"},{label:"Metal – Metalmania (Kevin MacLeod)",file:"/audio/kevin-macleod_metalmania.mp3",genre:"Metal"},{label:"Industrial – Industrial Music Box (Kevin MacLeod)",file:"/audio/kevin-macleod_industrial-music-box.mp3",genre:"Industrial"}]}},e=>{e.O(0,[367,19,441,964,358],()=>e(e.s=3544)),_N_E=e.O()}]);