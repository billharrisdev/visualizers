(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[747],{861:(e,t,n)=>{"use strict";function r(e){let t="/visualizers";return!t||e.startsWith(t+"/")?e:e.startsWith("/")?"".concat(t).concat(e):"".concat(t,"/").concat(e)}n.d(t,{O:()=>r})},2197:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(5155),a=n(2115),l=n(7431),c=n(3160),s=n(6369);function u(){let e=(0,a.useRef)(null),{analyser:t,ctx:n,play:u,pause:i,stop:o,isPlaying:d,setVolume:m}=(0,c.e)({fftSize:1024,smoothingTimeConstant:.7}),[f,h]=(0,a.useState)(0),[p,x]=(0,a.useState)(.7),b=(0,a.useRef)(null),g=(0,a.useRef)(null),v=(0,a.useRef)(null),w=(0,a.useRef)(null),y=(0,a.useRef)(null),k=(0,a.useRef)(null);return(0,a.useEffect)(()=>m(p),[p,m]),(0,a.useEffect)(()=>{let r=e.current;if(!r)return;let a=r.clientWidth,c=r.clientHeight||480,s=new l.JeP({antialias:!0,alpha:!0});s.setPixelRatio(Math.min(window.devicePixelRatio,2)),s.setSize(a,c),r.appendChild(s.domElement),b.current=s;let u=new l.Z58;g.current=u;let i=new l.ubm(60,a/c,.1,1e3);i.position.set(0,0,140),v.current=i;let o=new Float32Array(6e3),d=new Float32Array(6e3);for(let e=0;e<2e3;e++){let t=3*e;o[t+0]=(2*Math.random()-1)*100,o[t+1]=(2*Math.random()-1)*100,o[t+2]=(2*Math.random()-1)*100,d[t+0]=(2*Math.random()-1)*.2,d[t+1]=(2*Math.random()-1)*.2,d[t+2]=(2*Math.random()-1)*.2}y.current=d;let m=new l.LoY;m.setAttribute("position",new l.THS(o,3));let f=new l.BH$({color:new l.Q1f(6333946),size:1.8,transparent:!0,opacity:.9,sizeAttenuation:!0,depthWrite:!1}),h=new l.ONl(m,f);u.add(h),w.current=h;let p=()=>{if(!b.current||!v.current||!e.current)return;let t=e.current.clientWidth,n=e.current.clientHeight||480;b.current.setSize(t,n),v.current.aspect=t/n,v.current.updateProjectionMatrix()};window.addEventListener("resize",p);let x=()=>{k.current=requestAnimationFrame(x);let e=h.geometry.attributes.position,r=e.array,a=y.current,c=0,o=0,d=0;if(t&&n){let e=t.frequencyBinCount,r=new Uint8Array(e);t.getByteFrequencyData(r);let a=n.sampleRate/2,l=t=>Math.max(0,Math.min(e-1,Math.round(t/a*e))),s=(e,t)=>{let n=l(e),a=l(t),c=0,s=0;for(let e=n;e<=a;e++)c+=r[e],s++;return s?c/(255*s):0};c=s(20,150),o=s(150,2e3),d=s(2e3,8e3)}let m=.5+2*o;for(let e=0;e<r.length;e+=3){r[e+0]+=a[e+0]*m,r[e+1]+=a[e+1]*m,r[e+2]+=a[e+2]*m;for(let t=0;t<3;t++)r[e+t]>100?r[e+t]=-100:r[e+t]<-100&&(r[e+t]=100)}e.needsUpdate=!0;let f=h.material;f.size=1.8+4*c;let p=new l.Q1f().setHSL(.58-.15*Math.max(0,Math.min(1,d)),.8,.6+.2*d);f.color.copy(p),h.rotation.y+=.001+.01*d,s.render(u,i)};return x(),()=>{if(k.current&&cancelAnimationFrame(k.current),window.removeEventListener("resize",p),b.current){var e;b.current.dispose();let t=b.current.domElement;null==(e=t.parentElement)||e.removeChild(t)}h.geometry.dispose(),h.material.dispose(),u.clear()}},[t,n]),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-end gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Track"}),(0,r.jsx)("select",{className:"border rounded-md px-3 py-2 bg-background",value:f,onChange:e=>h(Number(e.target.value)),disabled:d,children:s.p.map((e,t)=>(0,r.jsx)("option",{value:t,children:e.label},e.file))})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:()=>u(s.p[f].file),disabled:d,children:"Play"}),(0,r.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:i,disabled:!d,children:"Pause"}),(0,r.jsx)("button",{className:"border rounded-md px-3 py-2 hover:bg-accent",onClick:o,children:"Stop"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("label",{className:"text-sm text-muted-foreground",children:"Volume"}),(0,r.jsx)("input",{type:"range",min:0,max:1,step:.01,value:p,onChange:e=>x(Number(e.target.value)),className:"w-40"}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground tabular-nums",children:[Math.round(100*p),"%"]})]})]}),(0,r.jsx)("div",{className:"border rounded-lg p-3 bg-muted/20",children:(0,r.jsx)("div",{ref:e,className:"w-full h-[480px]"})})]})}function i(){return(0,r.jsxs)("section",{className:"py-8 container max-w-5xl",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"3D Particle Field"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6",children:"three.js particles reacting to bass/mids/highs."}),(0,r.jsx)(u,{})]})}},3160:(e,t,n)=>{"use strict";n.d(t,{e:()=>l});var r=n(2115),a=n(861);function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{fftSize:t=2048,smoothingTimeConstant:n=.8}=e,l=(0,r.useRef)(null),c=(0,r.useRef)(null),s=(0,r.useRef)(null),u=(0,r.useRef)(null),i=(0,r.useRef)(null),[o,d]=(0,r.useState)(!1),[m,f]=(0,r.useState)(.7);(0,r.useEffect)(()=>{let e=new Audio;return e.crossOrigin="anonymous",l.current=e,()=>{e.pause(),e.src="",l.current=null}},[]);let h=(0,r.useCallback)(async()=>{let e=c.current;if(e||(c.current=e=new(window.AudioContext||window.webkitAudioContext)),s.current||(s.current=e.createMediaElementSource(l.current)),!u.current){let r=e.createAnalyser();r.fftSize=t,r.smoothingTimeConstant=n,u.current=r}if(!i.current){let t=e.createGain();t.gain.value=m,i.current=t}s.current.disconnect(),i.current.disconnect(),u.current.disconnect(),s.current.connect(i.current),i.current.connect(e.destination),s.current.connect(u.current)},[t,n,m]);(0,r.useEffect)(()=>{i.current&&(i.current.gain.value=m)},[m]);let p=(0,r.useCallback)(async e=>{await h();let t=l.current;t.src=(0,a.O)(e),await t.play(),d(!0)},[h]),x=(0,r.useCallback)(()=>{var e;null==(e=l.current)||e.pause(),d(!1)},[]),b=(0,r.useCallback)(()=>{l.current&&(l.current.pause(),l.current.currentTime=0),d(!1)},[]);return(0,r.useEffect)(()=>()=>{try{var e,t,n,r;null==(e=u.current)||e.disconnect(),null==(t=i.current)||t.disconnect(),null==(n=s.current)||n.disconnect(),null==(r=c.current)||r.close()}catch(e){}},[]),{audio:l.current,ctx:c.current,analyser:u.current,isPlaying:o,volume:m,setVolume:f,play:p,pause:x,stop:b}}},3544:(e,t,n)=>{Promise.resolve().then(n.bind(n,2197))},6369:(e,t,n)=>{"use strict";n.d(t,{p:()=>r});let r=[{label:"Rock – Take the Lead (Kevin MacLeod)",file:"/audio/kevin-macleod_take-the-lead.mp3",genre:"Rock"},{label:"Jazz – George Street Shuffle (Kevin MacLeod)",file:"/audio/kevin-macleod_george-street-shuffle.mp3",genre:"Jazz"},{label:"Metal – Metalmania (Kevin MacLeod)",file:"/audio/kevin-macleod_metalmania.mp3",genre:"Metal"},{label:"Industrial – Industrial Music Box (Kevin MacLeod)",file:"/audio/kevin-macleod_industrial-music-box.mp3",genre:"Industrial"}]}},e=>{e.O(0,[367,441,964,358],()=>e(e.s=3544)),_N_E=e.O()}]);